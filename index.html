<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Computer Graphics Essentials: From Display Hardware to Line Drawing</title>
    <style>
        :root {
  /* Primitive Color Tokens */
  --color-white: rgba(255, 255, 255, 1);
  --color-black: rgba(0, 0, 0, 1);
  --color-cream-50: rgba(252, 252, 249, 1);
  --color-cream-100: rgba(255, 255, 253, 1);
  --color-gray-200: rgba(245, 245, 245, 1);
  --color-gray-300: rgba(167, 169, 169, 1);
  --color-gray-400: rgba(119, 124, 124, 1);
  --color-slate-500: rgba(98, 108, 113, 1);
  --color-brown-600: rgba(94, 82, 64, 1);
  --color-charcoal-700: rgba(31, 33, 33, 1);
  --color-charcoal-800: rgba(38, 40, 40, 1);
  --color-slate-900: rgba(19, 52, 59, 1);
  --color-teal-300: rgba(50, 184, 198, 1);
  --color-teal-400: rgba(45, 166, 178, 1);
  --color-teal-500: rgba(33, 128, 141, 1);
  --color-teal-600: rgba(29, 116, 128, 1);
  --color-teal-700: rgba(26, 104, 115, 1);
  --color-teal-800: rgba(41, 150, 161, 1);
  --color-red-400: rgba(255, 84, 89, 1);
  --color-red-500: rgba(192, 21, 47, 1);
  --color-orange-400: rgba(230, 129, 97, 1);
  --color-orange-500: rgba(168, 75, 47, 1);

  /* RGB versions for opacity control */
  --color-brown-600-rgb: 94, 82, 64;
  --color-teal-500-rgb: 33, 128, 141;
  --color-slate-900-rgb: 19, 52, 59;
  --color-slate-500-rgb: 98, 108, 113;
  --color-red-500-rgb: 192, 21, 47;
  --color-red-400-rgb: 255, 84, 89;
  --color-orange-500-rgb: 168, 75, 47;
  --color-orange-400-rgb: 230, 129, 97;

  /* Background color tokens (Light Mode) */
  --color-bg-1: rgba(59, 130, 246, 0.08); /* Light blue */
  --color-bg-2: rgba(245, 158, 11, 0.08); /* Light yellow */
  --color-bg-3: rgba(34, 197, 94, 0.08); /* Light green */
  --color-bg-4: rgba(239, 68, 68, 0.08); /* Light red */
  --color-bg-5: rgba(147, 51, 234, 0.08); /* Light purple */
  --color-bg-6: rgba(249, 115, 22, 0.08); /* Light orange */
  --color-bg-7: rgba(236, 72, 153, 0.08); /* Light pink */
  --color-bg-8: rgba(6, 182, 212, 0.08); /* Light cyan */

  /* Semantic Color Tokens (Light Mode) */
  --color-background: var(--color-cream-50);
  --color-surface: var(--color-cream-100);
  --color-text: var(--color-slate-900);
  --color-text-secondary: var(--color-slate-500);
  --color-primary: var(--color-teal-500);
  --color-primary-hover: var(--color-teal-600);
  --color-primary-active: var(--color-teal-700);
  --color-secondary: rgba(var(--color-brown-600-rgb), 0.12);
  --color-secondary-hover: rgba(var(--color-brown-600-rgb), 0.2);
  --color-secondary-active: rgba(var(--color-brown-600-rgb), 0.25);
  --color-border: rgba(var(--color-brown-600-rgb), 0.2);
  --color-btn-primary-text: var(--color-cream-50);
  --color-card-border: rgba(var(--color-brown-600-rgb), 0.12);
  --color-card-border-inner: rgba(var(--color-brown-600-rgb), 0.12);
  --color-error: var(--color-red-500);
  --color-success: var(--color-teal-500);
  --color-warning: var(--color-orange-500);
  --color-info: var(--color-slate-500);
  --color-focus-ring: rgba(var(--color-teal-500-rgb), 0.4);
  --color-select-caret: rgba(var(--color-slate-900-rgb), 0.8);

  /* Common style patterns */
  --focus-ring: 0 0 0 3px var(--color-focus-ring);
  --focus-outline: 2px solid var(--color-primary);
  --status-bg-opacity: 0.15;
  --status-border-opacity: 0.25;
  --select-caret-light: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23134252' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
  --select-caret-dark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23f5f5f5' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");

  /* RGB versions for opacity control */
  --color-success-rgb: 33, 128, 141;
  --color-error-rgb: 192, 21, 47;
  --color-warning-rgb: 168, 75, 47;
  --color-info-rgb: 98, 108, 113;

  /* Typography */
  --font-family-base: "FKGroteskNeue", "Geist", "Inter", -apple-system,
    BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  --font-family-mono: "Berkeley Mono", ui-monospace, SFMono-Regular, Menlo,
    Monaco, Consolas, monospace;
  --font-size-xs: 11px;
  --font-size-sm: 12px;
  --font-size-base: 14px;
  --font-size-md: 14px;
  --font-size-lg: 16px;
  --font-size-xl: 18px;
  --font-size-2xl: 20px;
  --font-size-3xl: 24px;
  --font-size-4xl: 30px;
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 550;
  --font-weight-bold: 600;
  --line-height-tight: 1.2;
  --line-height-normal: 1.5;
  --letter-spacing-tight: -0.01em;

  /* Spacing */
  --space-0: 0;
  --space-1: 1px;
  --space-2: 2px;
  --space-4: 4px;
  --space-6: 6px;
  --space-8: 8px;
  --space-10: 10px;
  --space-12: 12px;
  --space-16: 16px;
  --space-20: 20px;
  --space-24: 24px;
  --space-32: 32px;

  /* Border Radius */
  --radius-sm: 6px;
  --radius-base: 8px;
  --radius-md: 10px;
  --radius-lg: 12px;
  --radius-full: 9999px;

  /* Shadows */
  --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.02);
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.02);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.04),
    0 2px 4px -1px rgba(0, 0, 0, 0.02);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.04),
    0 4px 6px -2px rgba(0, 0, 0, 0.02);
  --shadow-inset-sm: inset 0 1px 0 rgba(255, 255, 255, 0.15),
    inset 0 -1px 0 rgba(0, 0, 0, 0.03);

  /* Animation */
  --duration-fast: 150ms;
  --duration-normal: 250ms;
  --ease-standard: cubic-bezier(0.16, 1, 0.3, 1);

  /* Layout */
  --container-sm: 640px;
  --container-md: 768px;
  --container-lg: 1024px;
  --container-xl: 1280px;
}

/* Dark mode colors */
@media (prefers-color-scheme: dark) {
  :root {
    /* RGB versions for opacity control (Dark Mode) */
    --color-gray-400-rgb: 119, 124, 124;
    --color-teal-300-rgb: 50, 184, 198;
    --color-gray-300-rgb: 167, 169, 169;
    --color-gray-200-rgb: 245, 245, 245;

    /* Background color tokens (Dark Mode) */
    --color-bg-1: rgba(29, 78, 216, 0.15); /* Dark blue */
    --color-bg-2: rgba(180, 83, 9, 0.15); /* Dark yellow */
    --color-bg-3: rgba(21, 128, 61, 0.15); /* Dark green */
    --color-bg-4: rgba(185, 28, 28, 0.15); /* Dark red */
    --color-bg-5: rgba(107, 33, 168, 0.15); /* Dark purple */
    --color-bg-6: rgba(194, 65, 12, 0.15); /* Dark orange */
    --color-bg-7: rgba(190, 24, 93, 0.15); /* Dark pink */
    --color-bg-8: rgba(8, 145, 178, 0.15); /* Dark cyan */

    /* Semantic Color Tokens (Dark Mode) */
    --color-background: var(--color-charcoal-700);
    --color-surface: var(--color-charcoal-800);
    --color-text: var(--color-gray-200);
    --color-text-secondary: rgba(var(--color-gray-300-rgb), 0.7);
    --color-primary: var(--color-teal-300);
    --color-primary-hover: var(--color-teal-400);
    --color-primary-active: var(--color-teal-800);
    --color-secondary: rgba(var(--color-gray-400-rgb), 0.15);
    --color-secondary-hover: rgba(var(--color-gray-400-rgb), 0.25);
    --color-secondary-active: rgba(var(--color-gray-400-rgb), 0.3);
    --color-border: rgba(var(--color-gray-400-rgb), 0.3);
    --color-error: var(--color-red-400);
    --color-success: var(--color-teal-300);
    --color-warning: var(--color-orange-400);
    --color-info: var(--color-gray-300);
    --color-focus-ring: rgba(var(--color-teal-300-rgb), 0.4);
    --color-btn-primary-text: var(--color-slate-900);
    --color-card-border: rgba(var(--color-gray-400-rgb), 0.2);
    --color-card-border-inner: rgba(var(--color-gray-400-rgb), 0.15);
    --shadow-inset-sm: inset 0 1px 0 rgba(255, 255, 255, 0.1),
      inset 0 -1px 0 rgba(0, 0, 0, 0.15);
    --button-border-secondary: rgba(var(--color-gray-400-rgb), 0.2);
    --color-border-secondary: rgba(var(--color-gray-400-rgb), 0.2);
    --color-select-caret: rgba(var(--color-gray-200-rgb), 0.8);

    /* Common style patterns - updated for dark mode */
    --focus-ring: 0 0 0 3px var(--color-focus-ring);
    --focus-outline: 2px solid var(--color-primary);
    --status-bg-opacity: 0.15;
    --status-border-opacity: 0.25;
    --select-caret-light: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23134252' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
    --select-caret-dark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23f5f5f5' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");

    /* RGB versions for dark mode */
    --color-success-rgb: var(--color-teal-300-rgb);
    --color-error-rgb: var(--color-red-400-rgb);
    --color-warning-rgb: var(--color-orange-400-rgb);
    --color-info-rgb: var(--color-gray-300-rgb);
  }
}

/* Data attribute for manual theme switching */
[data-color-scheme="dark"] {
  /* RGB versions for opacity control (dark mode) */
  --color-gray-400-rgb: 119, 124, 124;
  --color-teal-300-rgb: 50, 184, 198;
  --color-gray-300-rgb: 167, 169, 169;
  --color-gray-200-rgb: 245, 245, 245;

  /* Colorful background palette - Dark Mode */
  --color-bg-1: rgba(29, 78, 216, 0.15); /* Dark blue */
  --color-bg-2: rgba(180, 83, 9, 0.15); /* Dark yellow */
  --color-bg-3: rgba(21, 128, 61, 0.15); /* Dark green */
  --color-bg-4: rgba(185, 28, 28, 0.15); /* Dark red */
  --color-bg-5: rgba(107, 33, 168, 0.15); /* Dark purple */
  --color-bg-6: rgba(194, 65, 12, 0.15); /* Dark orange */
  --color-bg-7: rgba(190, 24, 93, 0.15); /* Dark pink */
  --color-bg-8: rgba(8, 145, 178, 0.15); /* Dark cyan */

  /* Semantic Color Tokens (Dark Mode) */
  --color-background: var(--color-charcoal-700);
  --color-surface: var(--color-charcoal-800);
  --color-text: var(--color-gray-200);
  --color-text-secondary: rgba(var(--color-gray-300-rgb), 0.7);
  --color-primary: var(--color-teal-300);
  --color-primary-hover: var(--color-teal-400);
  --color-primary-active: var(--color-teal-800);
  --color-secondary: rgba(var(--color-gray-400-rgb), 0.15);
  --color-secondary-hover: rgba(var(--color-gray-400-rgb), 0.25);
  --color-secondary-active: rgba(var(--color-gray-400-rgb), 0.3);
  --color-border: rgba(var(--color-gray-400-rgb), 0.3);
  --color-error: var(--color-red-400);
  --color-success: var(--color-teal-300);
  --color-warning: var(--color-orange-400);
  --color-info: var(--color-gray-300);
  --color-focus-ring: rgba(var(--color-teal-300-rgb), 0.4);
  --color-btn-primary-text: var(--color-slate-900);
  --color-card-border: rgba(var(--color-gray-400-rgb), 0.15);
  --color-card-border-inner: rgba(var(--color-gray-400-rgb), 0.15);
  --shadow-inset-sm: inset 0 1px 0 rgba(255, 255, 255, 0.1),
    inset 0 -1px 0 rgba(0, 0, 0, 0.15);
  --color-border-secondary: rgba(var(--color-gray-400-rgb), 0.2);
  --color-select-caret: rgba(var(--color-gray-200-rgb), 0.8);

  /* Common style patterns - updated for dark mode */
  --focus-ring: 0 0 0 3px var(--color-focus-ring);
  --focus-outline: 2px solid var(--color-primary);
  --status-bg-opacity: 0.15;
  --status-border-opacity: 0.25;
  --select-caret-light: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23134252' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
  --select-caret-dark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23f5f5f5' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");

  /* RGB versions for dark mode */
  --color-success-rgb: var(--color-teal-300-rgb);
  --color-error-rgb: var(--color-red-400-rgb);
  --color-warning-rgb: var(--color-orange-400-rgb);
  --color-info-rgb: var(--color-gray-300-rgb);
}

[data-color-scheme="light"] {
  /* RGB versions for opacity control (light mode) */
  --color-brown-600-rgb: 94, 82, 64;
  --color-teal-500-rgb: 33, 128, 141;
  --color-slate-900-rgb: 19, 52, 59;

  /* Semantic Color Tokens (Light Mode) */
  --color-background: var(--color-cream-50);
  --color-surface: var(--color-cream-100);
  --color-text: var(--color-slate-900);
  --color-text-secondary: var(--color-slate-500);
  --color-primary: var(--color-teal-500);
  --color-primary-hover: var(--color-teal-600);
  --color-primary-active: var(--color-teal-700);
  --color-secondary: rgba(var(--color-brown-600-rgb), 0.12);
  --color-secondary-hover: rgba(var(--color-brown-600-rgb), 0.2);
  --color-secondary-active: rgba(var(--color-brown-600-rgb), 0.25);
  --color-border: rgba(var(--color-brown-600-rgb), 0.2);
  --color-btn-primary-text: var(--color-cream-50);
  --color-card-border: rgba(var(--color-brown-600-rgb), 0.12);
  --color-card-border-inner: rgba(var(--color-brown-600-rgb), 0.12);
  --color-error: var(--color-red-500);
  --color-success: var(--color-teal-500);
  --color-warning: var(--color-orange-500);
  --color-info: var(--color-slate-500);
  --color-focus-ring: rgba(var(--color-teal-500-rgb), 0.4);

  /* RGB versions for light mode */
  --color-success-rgb: var(--color-teal-500-rgb);
  --color-error-rgb: var(--color-red-500-rgb);
  --color-warning-rgb: var(--color-orange-500-rgb);
  --color-info-rgb: var(--color-slate-500-rgb);
}

/* Base styles */
html {
  font-size: var(--font-size-base);
  font-family: var(--font-family-base);
  line-height: var(--line-height-normal);
  color: var(--color-text);
  background-color: var(--color-background);
  -webkit-font-smoothing: antialiased;
  box-sizing: border-box;
}

body {
  margin: 0;
  padding: 0;
}

*,
*::before,
*::after {
  box-sizing: inherit;
}

/* Typography */
h1,
h2,
h3,
h4,
h5,
h6 {
  margin: 0;
  font-weight: var(--font-weight-semibold);
  line-height: var(--line-height-tight);
  color: var(--color-text);
  letter-spacing: var(--letter-spacing-tight);
}

h1 {
  font-size: var(--font-size-4xl);
}
h2 {
  font-size: var(--font-size-3xl);
}
h3 {
  font-size: var(--font-size-2xl);
}
h4 {
  font-size: var(--font-size-xl);
}
h5 {
  font-size: var(--font-size-lg);
}
h6 {
  font-size: var(--font-size-md);
}

p {
  margin: 0 0 var(--space-16) 0;
}

a {
  color: var(--color-primary);
  text-decoration: none;
  transition: color var(--duration-fast) var(--ease-standard);
}

a:hover {
  color: var(--color-primary-hover);
}

code,
pre {
  font-family: var(--font-family-mono);
  font-size: calc(var(--font-size-base) * 0.95);
  background-color: var(--color-secondary);
  border-radius: var(--radius-sm);
}

code {
  padding: var(--space-1) var(--space-4);
}

pre {
  padding: var(--space-16);
  margin: var(--space-16) 0;
  overflow: auto;
  border: 1px solid var(--color-border);
}

pre code {
  background: none;
  padding: 0;
}

/* Buttons */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-8) var(--space-16);
  border-radius: var(--radius-base);
  font-size: var(--font-size-base);
  font-weight: 500;
  line-height: 1.5;
  cursor: pointer;
  transition: all var(--duration-normal) var(--ease-standard);
  border: none;
  text-decoration: none;
  position: relative;
}

.btn:focus-visible {
  outline: none;
  box-shadow: var(--focus-ring);
}

.btn--primary {
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
}

.btn--primary:hover {
  background: var(--color-primary-hover);
}

.btn--primary:active {
  background: var(--color-primary-active);
}

.btn--secondary {
  background: var(--color-secondary);
  color: var(--color-text);
}

.btn--secondary:hover {
  background: var(--color-secondary-hover);
}

.btn--secondary:active {
  background: var(--color-secondary-active);
}

.btn--outline {
  background: transparent;
  border: 1px solid var(--color-border);
  color: var(--color-text);
}

.btn--outline:hover {
  background: var(--color-secondary);
}

.btn--sm {
  padding: var(--space-4) var(--space-12);
  font-size: var(--font-size-sm);
  border-radius: var(--radius-sm);
}

.btn--lg {
  padding: var(--space-10) var(--space-20);
  font-size: var(--font-size-lg);
  border-radius: var(--radius-md);
}

.btn--full-width {
  width: 100%;
}

.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Form elements */
.form-control {
  display: block;
  width: 100%;
  padding: var(--space-8) var(--space-12);
  font-size: var(--font-size-md);
  line-height: 1.5;
  color: var(--color-text);
  background-color: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-base);
  transition: border-color var(--duration-fast) var(--ease-standard),
    box-shadow var(--duration-fast) var(--ease-standard);
}

textarea.form-control {
  font-family: var(--font-family-base);
  font-size: var(--font-size-base);
}

select.form-control {
  padding: var(--space-8) var(--space-12);
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  background-image: var(--select-caret-light);
  background-repeat: no-repeat;
  background-position: right var(--space-12) center;
  background-size: 16px;
  padding-right: var(--space-32);
}

/* Add a dark mode specific caret */
@media (prefers-color-scheme: dark) {
  select.form-control {
    background-image: var(--select-caret-dark);
  }
}

/* Also handle data-color-scheme */
[data-color-scheme="dark"] select.form-control {
  background-image: var(--select-caret-dark);
}

[data-color-scheme="light"] select.form-control {
  background-image: var(--select-caret-light);
}

.form-control:focus {
  border-color: var(--color-primary);
  outline: var(--focus-outline);
}

.form-label {
  display: block;
  margin-bottom: var(--space-8);
  font-weight: var(--font-weight-medium);
  font-size: var(--font-size-sm);
}

.form-group {
  margin-bottom: var(--space-16);
}

/* Card component */
.card {
  background-color: var(--color-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-card-border);
  box-shadow: var(--shadow-sm);
  overflow: hidden;
  transition: box-shadow var(--duration-normal) var(--ease-standard);
}

.card:hover {
  box-shadow: var(--shadow-md);
}

.card__body {
  padding: var(--space-16);
}

.card__header,
.card__footer {
  padding: var(--space-16);
  border-bottom: 1px solid var(--color-card-border-inner);
}

/* Status indicators - simplified with CSS variables */
.status {
  display: inline-flex;
  align-items: center;
  padding: var(--space-6) var(--space-12);
  border-radius: var(--radius-full);
  font-weight: var(--font-weight-medium);
  font-size: var(--font-size-sm);
}

.status--success {
  background-color: rgba(
    var(--color-success-rgb, 33, 128, 141),
    var(--status-bg-opacity)
  );
  color: var(--color-success);
  border: 1px solid
    rgba(var(--color-success-rgb, 33, 128, 141), var(--status-border-opacity));
}

.status--error {
  background-color: rgba(
    var(--color-error-rgb, 192, 21, 47),
    var(--status-bg-opacity)
  );
  color: var(--color-error);
  border: 1px solid
    rgba(var(--color-error-rgb, 192, 21, 47), var(--status-border-opacity));
}

.status--warning {
  background-color: rgba(
    var(--color-warning-rgb, 168, 75, 47),
    var(--status-bg-opacity)
  );
  color: var(--color-warning);
  border: 1px solid
    rgba(var(--color-warning-rgb, 168, 75, 47), var(--status-border-opacity));
}

.status--info {
  background-color: rgba(
    var(--color-info-rgb, 98, 108, 113),
    var(--status-bg-opacity)
  );
  color: var(--color-info);
  border: 1px solid
    rgba(var(--color-info-rgb, 98, 108, 113), var(--status-border-opacity));
}

/* Container layout */
.container {
  width: 100%;
  margin-right: auto;
  margin-left: auto;
  padding-right: var(--space-16);
  padding-left: var(--space-16);
}

@media (min-width: 640px) {
  .container {
    max-width: var(--container-sm);
  }
}
@media (min-width: 768px) {
  .container {
    max-width: var(--container-md);
  }
}
@media (min-width: 1024px) {
  .container {
    max-width: var(--container-lg);
  }
}
@media (min-width: 1280px) {
  .container {
    max-width: var(--container-xl);
  }
}

/* Utility classes */
.flex {
  display: flex;
}
.flex-col {
  flex-direction: column;
}
.items-center {
  align-items: center;
}
.justify-center {
  justify-content: center;
}
.justify-between {
  justify-content: space-between;
}
.gap-4 {
  gap: var(--space-4);
}
.gap-8 {
  gap: var(--space-8);
}
.gap-16 {
  gap: var(--space-16);
}

.m-0 {
  margin: 0;
}
.mt-8 {
  margin-top: var(--space-8);
}
.mb-8 {
  margin-bottom: var(--space-8);
}
.mx-8 {
  margin-left: var(--space-8);
  margin-right: var(--space-8);
}
.my-8 {
  margin-top: var(--space-8);
  margin-bottom: var(--space-8);
}

.p-0 {
  padding: 0;
}
.py-8 {
  padding-top: var(--space-8);
  padding-bottom: var(--space-8);
}
.px-8 {
  padding-left: var(--space-8);
  padding-right: var(--space-8);
}
.py-16 {
  padding-top: var(--space-16);
  padding-bottom: var(--space-16);
}
.px-16 {
  padding-left: var(--space-16);
  padding-right: var(--space-16);
}

.block {
  display: block;
}
.hidden {
  display: none;
}

/* Accessibility */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

:focus-visible {
  outline: var(--focus-outline);
  outline-offset: 2px;
}

/* Dark mode specifics */
[data-color-scheme="dark"] .btn--outline {
  border: 1px solid var(--color-border-secondary);
}

@font-face {
  font-family: 'FKGroteskNeue';
  src: url('https://r2cdn.perplexity.ai/fonts/FKGroteskNeue.woff2')
    format('woff2');
}

/* END PERPLEXITY DESIGN SYSTEM */

        /* Custom styles for flashcard app */
        .app {
            min-height: 100vh;
            padding: var(--space-16);
        }

        .header {
            text-align: center;
            margin-bottom: var(--space-32);
        }

        .dashboard {
            max-width: 1200px;
            margin: 0 auto;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--space-16);
            margin-bottom: var(--space-32);
        }

        .stat-card {
            background: var(--color-surface);
            border: 1px solid var(--color-card-border);
            border-radius: var(--radius-lg);
            padding: var(--space-20);
            text-align: center;
            box-shadow: var(--shadow-sm);
            transition: transform var(--duration-normal) var(--ease-standard);
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .stat-number {
            font-size: var(--font-size-3xl);
            font-weight: var(--font-weight-bold);
            color: var(--color-primary);
            margin-bottom: var(--space-8);
        }

        .stat-label {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--space-16);
            margin-bottom: var(--space-32);
        }

        .control-group {
            background: var(--color-surface);
            border: 1px solid var(--color-card-border);
            border-radius: var(--radius-lg);
            padding: var(--space-20);
        }

        .control-title {
            font-weight: var(--font-weight-semibold);
            margin-bottom: var(--space-12);
            color: var(--color-text);
        }

        .btn-group {
            display: flex;
            gap: var(--space-8);
            flex-wrap: wrap;
        }

        .btn-group .btn {
            flex: 1;
            min-width: 100px;
        }

        .search-box {
            width: 100%;
            margin-bottom: var(--space-12);
        }

        .flashcard-container {
            max-width: 800px;
            margin: 0 auto;
            padding: var(--space-16);
        }

        .flashcard {
            perspective: 1000px;
            margin: var(--space-32) auto;
        }

        .flashcard-inner {
            position: relative;
            width: 100%;
            min-height: 300px;
            transition: transform var(--duration-normal) var(--ease-standard);
            transform-style: preserve-3d;
            cursor: pointer;
        }

        .flashcard.flipped .flashcard-inner {
            transform: rotateY(180deg);
        }

        .flashcard-front,
        .flashcard-back {
            position: absolute;
            width: 100%;
            min-height: 300px;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: var(--space-32);
            border-radius: var(--radius-lg);
            border: 1px solid var(--color-card-border);
            box-shadow: var(--shadow-lg);
        }

        .flashcard-front {
            background: var(--color-bg-1);
        }

        .flashcard-back {
            background: var(--color-bg-3);
            transform: rotateY(180deg);
        }

        .card-content {
            font-size: var(--font-size-lg);
            line-height: 1.6;
            max-width: 100%;
        }

        .card-content h3 {
            margin-bottom: var(--space-16);
            color: var(--color-text);
        }

        .card-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-16);
        }

        .card-progress {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
        }

        .category-badge {
            background: var(--color-primary);
            color: var(--color-btn-primary-text);
            padding: var(--space-4) var(--space-8);
            border-radius: var(--radius-sm);
            font-size: var(--font-size-xs);
            font-weight: var(--font-weight-medium);
        }

        .navigation {
            display: flex;
            justify-content: center;
            gap: var(--space-16);
            margin: var(--space-24) 0;
        }

        .navigation .btn {
            min-width: 120px;
        }

        .difficulty-rating {
            display: flex;
            justify-content: center;
            gap: var(--space-8);
            margin: var(--space-24) 0;
        }

        .difficulty-btn {
            padding: var(--space-8) var(--space-16);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-base);
            background: var(--color-surface);
            cursor: pointer;
            transition: all var(--duration-fast) var(--ease-standard);
            font-size: var(--font-size-sm);
        }

        .difficulty-btn.easy {
            border-color: var(--color-success);
            color: var(--color-success);
        }

        .difficulty-btn.medium {
            border-color: var(--color-warning);
            color: var(--color-warning);
        }

        .difficulty-btn.hard {
            border-color: var(--color-error);
            color: var(--color-error);
        }

        .difficulty-btn.active.easy {
            background: rgba(var(--color-success-rgb), 0.1);
        }

        .difficulty-btn.active.medium {
            background: rgba(var(--color-warning-rgb), 0.1);
        }

        .difficulty-btn.active.hard {
            background: rgba(var(--color-error-rgb), 0.1);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--color-secondary);
            border-radius: var(--radius-sm);
            margin: var(--space-16) 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--color-primary);
            transition: width var(--duration-normal) var(--ease-standard);
            border-radius: var(--radius-sm);
        }

        .flip-hint {
            text-align: center;
            color: var(--color-text-secondary);
            font-size: var(--font-size-sm);
            margin-top: var(--space-16);
        }

        .back-btn {
            position: absolute;
            top: var(--space-16);
            left: var(--space-16);
            z-index: 10;
        }

        .keyboard-hints {
            background: var(--color-bg-2);
            border: 1px solid var(--color-card-border);
            border-radius: var(--radius-base);
            padding: var(--space-12);
            margin: var(--space-16) 0;
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
        }

        .keyboard-hints strong {
            color: var(--color-text);
        }

        /* Mobile responsive */
        @media (max-width: 640px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .controls {
                grid-template-columns: 1fr;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .btn-group .btn {
                flex: none;
                width: 100%;
            }
            
            .navigation {
                flex-direction: column;
                align-items: center;
            }
            
            .difficulty-rating {
                flex-wrap: wrap;
            }
            
            .flashcard-front,
            .flashcard-back {
                min-height: 250px;
                padding: var(--space-20);
            }
            
            .card-content {
                font-size: var(--font-size-base);
            }
        }

        /* Auto-advance timer */
        .timer-display {
            text-align: center;
            margin: var(--space-16) 0;
            font-size: var(--font-size-lg);
            color: var(--color-primary);
        }

        /* Animation for card transitions */
        .card-transition {
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
    </style>
</head>
<body>
    <div class="app">
        <div class="header">
            <h1>Computer Graphics Essentials: From Display Hardware to Line Drawing</h1>
            <p class="mt-8">Master the concepts with interactive flashcards</p>
        </div>

        <!-- Dashboard View -->
        <div id="dashboard" class="dashboard">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalCards">0</div>
                    <div class="stat-label">Total Cards</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="studiedCards">0</div>
                    <div class="stat-label">Cards Studied</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="easyCards">0</div>
                    <div class="stat-label">Easy Cards</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="hardCards">0</div>
                    <div class="stat-label">Hard Cards</div>
                </div>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="overallProgress" style="width: 0%"></div>
            </div>

            <div class="controls">
                <div class="control-group">
                    <h3 class="control-title">Study Mode</h3>
                    <div class="btn-group">
                        <button class="btn btn--primary" onclick="startStudy('sequential')">Sequential</button>
                        <button class="btn btn--secondary" onclick="startStudy('random')">Random</button>
                        <button class="btn btn--outline" onclick="startStudy('review')">Review Hard</button>
                    </div>
                </div>

                <div class="control-group">
                    <h3 class="control-title">Filter by Lecture</h3>
                    <select class="form-control" id="categoryFilter" onchange="updateFilters()">
                        <option value="all">All Lectures</option>
                        <option value="Lecture 1">Lecture 1</option>
                        <option value="Lecture 2">Lecture 2</option>
                        <option value="Lecture 3">Lecture 3</option>
                        <option value="Lecture 4">Lecture 4</option>
                    </select>
                </div>

                <div class="control-group">
                    <h3 class="control-title">Search Cards</h3>
                    <input type="text" class="form-control search-box" id="searchInput" 
                           placeholder="Search questions or answers..." 
                           oninput="updateSearch()">
                    <button class="btn btn--outline btn--full-width" onclick="clearSearch()">Clear Search</button>
                </div>

                <div class="control-group">
                    <h3 class="control-title">Settings</h3>
                    <div class="form-group">
                        <label class="form-label">
                            <input type="checkbox" id="autoAdvance" onchange="toggleAutoAdvance()"> 
                            Auto-advance (10s)
                        </label>
                    </div>
                    <button class="btn btn--outline btn--full-width" onclick="resetProgress()">Reset All Progress</button>
                </div>
            </div>

            <div class="keyboard-hints">
                <strong>Keyboard Shortcuts:</strong> Space = Flip card, ← → = Navigate, R = Random mode, S = Sequential mode
            </div>
        </div>

        <!-- Flashcard Study View -->
        <div id="studyView" class="flashcard-container hidden">
            <button class="btn btn--secondary back-btn" onclick="backToDashboard()">
                ← Back to Dashboard
            </button>

            <div class="card-meta">
                <div class="card-progress" id="cardProgress">Card 1 of 10</div>
                <div class="category-badge" id="cardCategory">Lecture 1</div>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="studyProgress" style="width: 0%"></div>
            </div>

            <div class="flashcard" id="flashcard" onclick="flipCard()">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <div class="card-content">
                            <h3>Question</h3>
                            <p id="questionText">Click to start studying!</p>
                        </div>
                    </div>
                    <div class="flashcard-back">
                        <div class="card-content">
                            <h3>Answer</h3>
                            <p id="answerText">Answer will appear here</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="flip-hint">Click card or press Space to flip</div>

            <div class="navigation">
                <button class="btn btn--secondary" id="prevBtn" onclick="previousCard()">← Previous</button>
                <button class="btn btn--primary" id="nextBtn" onclick="nextCard()">Next →</button>
            </div>

            <div class="difficulty-rating">
                <button class="difficulty-btn easy" onclick="rateDifficulty('easy')">Easy</button>
                <button class="difficulty-btn medium" onclick="rateDifficulty('medium')">Medium</button>
                <button class="difficulty-btn hard" onclick="rateDifficulty('hard')">Hard</button>
            </div>

            <div class="timer-display" id="timerDisplay" style="display: none;"></div>
        </div>

        <footer class="container" style="text-align: center; margin-top: var(--space-32); color: var(--color-text-secondary);">
            Copyright@Zunaid Hasan
        </footer>
    </div>

    <script>
        // Flashcard data
        const flashcards = [
            {
                question: "What is Computer Graphics?",
                answer: "Computer Graphics is the use of computers to display and manipulate information in graphical or pictorial form, either on a visual-display unit or via a printer or plotter.",
                category: "Lecture 1"
            },
            {
                question: "Name 4 major applications of Computer Graphics",
                answer: "1. Computer-Aided Design (CAD)\n2. Presentation Graphics\n3. Computer Art\n4. Entertainment\n5. Education and Training\n6. Visualization\n7. Image Processing\n8. Graphical User Interface (GUI)",
                category: "Lecture 1"
            },
            {
                question: "What is CAD in Computer Graphics?",
                answer: "Computer-Aided Design - uses animations, wireframe displays, realistic lighting models and surface rendering for designing and testing vehicles, manufacturing processes, and circuit layouts.",
                category: "Lecture 1"
            },
            {
                question: "What are Presentation Graphics?",
                answer: "Graphics used for producing illustrations for reports or slides - includes bar charts, line graphs, surface graphs, pie charts, and other displays showing relationships between data.",
                category: "Lecture 1"
            },
            {
                question: "What is the role of Computer Graphics in Entertainment?",
                answer: "Used in producing computer animation for films, television, music videos, often combining live action with computer graphics scenes for special effects.",
                category: "Lecture 1"
            },
            {
                question: "What is Visualization in Computer Graphics?",
                answer: "Converting data and information into pictures to gain insight and better understanding - used in scientific, engineering, medical, and business applications.",
                category: "Lecture 1"
            },
            {
                question: "What is Image Processing?",
                answer: "Techniques applied to modify or interpret existing images - includes digitization, storage, image enhancement, and analysis. Important in medical applications.",
                category: "Lecture 1"
            },
            {
                question: "What is a GUI?",
                answer: "Graphical User Interface - a component that uses windows, icons, menus, and pointing devices for user interaction with computer systems.",
                category: "Lecture 1"
            },
            {
                question: "What is a Cathode-Ray Tube (CRT)?",
                answer: "A display device where a beam of electrons (cathode rays) emitted by an electron gun passes through focusing and deflection systems to specified positions on a phosphor-coated screen, emitting light.",
                category: "Lecture 2"
            },
            {
                question: "Why does CRT need refresh?",
                answer: "Because the light emitted by the phosphor fades very rapidly, so the picture must be redrawn repeatedly and quickly to maintain a stable image.",
                category: "Lecture 2"
            },
            {
                question: "What is a Raster Scan Display?",
                answer: "A display system where the electron beam sweeps across the screen one row at a time from top to bottom. Picture information is stored in a refresh/frame buffer.",
                category: "Lecture 2"
            },
            {
                question: "What is a Random-Scan Display?",
                answer: "Also called vector display - draws only the required lines/components of the picture. Picture is stored as a set of line-drawing commands in a refresh display file.",
                category: "Lecture 2"
            },
            {
                question: "What is the typical refresh rate for displays?",
                answer: "60 to 80 frames per second to avoid flicker.",
                category: "Lecture 2"
            },
            {
                question: "What are the two methods for color CRT?",
                answer: "1. Beam-Penetration Method\n2. Shadow-Mask Method",
                category: "Lecture 2"
            },
            {
                question: "Explain Beam-Penetration Method",
                answer: "Uses layered phosphor (red and green). The speed of electrons determines which layer glows. Limited color range, primarily produces red and green.",
                category: "Lecture 2"
            },
            {
                question: "Explain Shadow-Mask Method",
                answer: "Uses three electron guns (one each for Red, Green, Blue) and a shadow mask with holes. Each gun illuminates specific color phosphor dots, allowing wide range of colors.",
                category: "Lecture 2"
            },
            {
                question: "What is a Direct-View Storage Tube (DVST)?",
                answer: "A display that stores picture information inside the CRT, eliminating need for refresh. Good for complex static images but cannot erase selectively - must redraw entire screen.",
                category: "Lecture 2"
            },
            {
                question: "What are the two types of Flat-Panel Displays?",
                answer: "1. Emissive Displays (convert electrical energy to light)\n2. Non-Emissive Displays (use optical effects to convert light)",
                category: "Lecture 2"
            },
            {
                question: "Name 3 types of Emissive Displays",
                answer: "1. Plasma Panel\n2. Thin-Film Electroluminescent Display\n3. LED (Light-Emitting Diode)",
                category: "Lecture 2"
            },
            {
                question: "What is a Plasma Panel?",
                answer: "Constructed by filling region between two glass plates with mixture of gases (neon + argon). Ionized gas emits light. Forms glowing spots at intersections.",
                category: "Lecture 2"
            },
            {
                question: "What is LCD?",
                answer: "Liquid Crystal Display - a non-emissive display that uses liquid crystals to control light passage. Requires backlight or external light source.",
                category: "Lecture 2"
            },
            {
                question: "Advantages of LED displays?",
                answer: "Fast, reliable, low power consumption, long life, small size, lightweight.",
                category: "Lecture 2"
            },
            {
                question: "Disadvantages of LCD?",
                answer: "Limited viewing angle, brightness depends on external light source.",
                category: "Lecture 2"
            },
            {
                question: "What are the 3 popular line drawing algorithms?",
                answer: "1. Digital Differential Analyzer (DDA) Line Drawing Algorithm\n2. Bresenham Line Drawing Algorithm\n3. Mid Point Line Drawing Algorithm",
                category: "Lecture 3"
            },
            {
                question: "What is DDA Algorithm?",
                answer: "Digital Differential Analyzer - the simplest line drawing algorithm that generates points between starting and ending coordinates of a line.",
                category: "Lecture 3"
            },
            {
                question: "What are the initial parameters for DDA?",
                answer: "ΔX = Xn - X0\nΔY = Yn - Y0\nM = ΔY / ΔX (slope)",
                category: "Lecture 3"
            },
            {
                question: "What are the 4 cases in DDA Algorithm?",
                answer: "Case 1: M < 1 → X1 = X0 + ΔX, Y1 = Y0 + M × ΔX\nCase 2: M ≥ 1 → X1 = X0 + ΔY / M, Y1 = Y0 + ΔY\nCase 3: M = 1 → X1 = X0 + ΔX, Y1 = Y0 + ΔY\nCase 4: M undefined (vertical line)",
                category: "Lecture 3"
            },
            {
                question: "What is the stopping condition for DDA?",
                answer: "Keep repeating until end point is reached OR number of generated points equals the steps count.",
                category: "Lecture 3"
            },
            {
                question: "Advantages of DDA Algorithm?",
                answer: "1. Simple and easy to implement\n2. Fast method for calculating pixel positions\n3. Eliminates multiplication by using incremental calculations",
                category: "Lecture 3"
            },
            {
                question: "Disadvantages of DDA Algorithm?",
                answer: "1. Uses floating point arithmetic (slower)\n2. Requires rounding operations\n3. Less accurate for circles and curves\n4. Time consuming due to rounding",
                category: "Lecture 3"
            },
            {
                question: "What is Bresenham Line Drawing Algorithm?",
                answer: "An incremental scan conversion algorithm that uses ONLY integer calculations to generate line points, making it faster and more efficient than DDA.",
                category: "Lecture 4"
            },
            {
                question: "What is the key advantage of Bresenham over DDA?",
                answer: "Uses only INTEGER arithmetic (addition/subtraction) instead of floating-point operations, making it much faster.",
                category: "Lecture 4"
            },
            {
                question: "What is the decision parameter in Bresenham?",
                answer: "Pk - a parameter used to decide which pixel to select next. Based on the difference between upper and lower pixel distances from the mathematical line.",
                category: "Lecture 4"
            },
            {
                question: "Initial decision parameter for Bresenham?",
                answer: "P0 = 2Δy - Δx (for slope < 1)",
                category: "Lecture 4"
            },
            {
                question: "Decision rules in Bresenham Algorithm?",
                answer: "If Pk < 0: Select lower pixel, Pk+1 = Pk + 2Δy\nIf Pk ≥ 0: Select upper pixel, Pk+1 = Pk + 2Δy - 2Δx",
                category: "Lecture 4"
            },
            {
                question: "Advantages of Bresenham Algorithm?",
                answer: "1. Uses only integer arithmetic\n2. Faster than DDA\n3. More accurate for lines and circles\n4. No rounding required\n5. More efficient",
                category: "Lecture 4"
            },
            {
                question: "Disadvantages of Bresenham Algorithm?",
                answer: "1. Still produces non-smooth lines in some cases\n2. More complex to understand than DDA",
                category: "Lecture 4"
            },
            {
                question: "DDA vs Bresenham: Arithmetic?",
                answer: "DDA: Floating-point arithmetic\nBresenham: Integer arithmetic",
                category: "Lecture 4"
            },
            {
                question: "DDA vs Bresenham: Speed?",
                answer: "DDA: Slower due to real arithmetic and rounding\nBresenham: Faster due to integer-only operations",
                category: "Lecture 4"
            },
            {
                question: "DDA vs Bresenham: Accuracy?",
                answer: "DDA: Lower accuracy for curves/circles\nBresenham: Higher accuracy",
                category: "Lecture 4"
            },
            {
                question: "DDA vs Bresenham: Operations?",
                answer: "DDA: Multiplication and division\nBresenham: Only addition and subtraction",
                category: "Lecture 4"
            }
        ];

        // Application state
        let currentCardIndex = 0;
        let isFlipped = false;
        let studyMode = 'sequential';
        let currentDeck = [...flashcards];
        let cardProgress = {}; // Track progress for each card
        let autoAdvanceTimer = null;
        let autoAdvanceEnabled = false;
        let searchTerm = '';
        let categoryFilter = 'all';

        // Initialize progress tracking
        function initializeProgress() {
            flashcards.forEach((card, index) => {
                if (!cardProgress[index]) {
                    cardProgress[index] = {
                        studied: false,
                        difficulty: null,
                        reviewCount: 0
                    };
                }
            });
        }

        // Update statistics
        function updateStats() {
            const total = currentDeck.length;
            let studied = 0;
            let easy = 0;
            let hard = 0;

            Object.values(cardProgress).forEach(progress => {
                if (progress.studied) studied++;
                if (progress.difficulty === 'easy') easy++;
                if (progress.difficulty === 'hard') hard++;
            });

            document.getElementById('totalCards').textContent = total;
            document.getElementById('studiedCards').textContent = studied;
            document.getElementById('easyCards').textContent = easy;
            document.getElementById('hardCards').textContent = hard;

            const overallProgress = total > 0 ? (studied / total) * 100 : 0;
            document.getElementById('overallProgress').style.width = overallProgress + '%';
        }

        // Filter and search functions
        function updateFilters() {
            categoryFilter = document.getElementById('categoryFilter').value;
            applyFilters();
        }

        function updateSearch() {
            searchTerm = document.getElementById('searchInput').value.toLowerCase();
            applyFilters();
        }

        function clearSearch() {
            document.getElementById('searchInput').value = '';
            searchTerm = '';
            applyFilters();
        }

        function applyFilters() {
            let filteredCards = flashcards.filter(card => {
                const matchesCategory = categoryFilter === 'all' || card.category === categoryFilter;
                const matchesSearch = searchTerm === '' || 
                    card.question.toLowerCase().includes(searchTerm) || 
                    card.answer.toLowerCase().includes(searchTerm);
                return matchesCategory && matchesSearch;
            });

            currentDeck = filteredCards;
            
            // If in study mode and current card is filtered out, go back to dashboard
            if (document.getElementById('studyView').style.display !== 'none') {
                if (currentDeck.length === 0 || 
                    !currentDeck.some((card, index) => flashcards.findIndex(c => c === card) === getCurrentCardIndex())) {
                    backToDashboard();
                } else {
                    // Reset to first card of filtered deck
                    currentCardIndex = 0;
                    updateCard();
                }
            }
            
            updateStats();
        }

        // Get the original index of current card
        function getCurrentCardIndex() {
            const currentCard = currentDeck[currentCardIndex];
            return flashcards.findIndex(card => card === currentCard);
        }

        // Study mode functions
        function startStudy(mode) {
            if (currentDeck.length === 0) {
                alert('No cards match your current filters!');
                return;
            }

            studyMode = mode;
            
            // Filter deck based on study mode
            if (mode === 'review') {
                currentDeck = flashcards.filter((card, index) => 
                    cardProgress[index] && cardProgress[index].difficulty === 'hard'
                );
                
                if (currentDeck.length === 0) {
                    alert('No hard cards to review! Study some cards first.');
                    return;
                }
            } else {
                // Apply current filters
                applyFilters();
            }

            if (mode === 'random') {
                shuffleDeck();
            }

            currentCardIndex = 0;
            document.getElementById('dashboard').classList.add('hidden');
            document.getElementById('studyView').classList.remove('hidden');
            updateCard();
        }

        function shuffleDeck() {
            for (let i = currentDeck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [currentDeck[i], currentDeck[j]] = [currentDeck[j], currentDeck[i]];
            }
        }

        // Card navigation
        function updateCard() {
            if (currentDeck.length === 0) return;

            const card = currentDeck[currentCardIndex];
            const originalIndex = getCurrentCardIndex();
            
            document.getElementById('questionText').textContent = card.question;
            document.getElementById('answerText').innerHTML = card.answer.replace(/\n/g, '<br>');
            document.getElementById('cardCategory').textContent = card.category;
            
            // Update progress indicator
            document.getElementById('cardProgress').textContent = 
                `Card ${currentCardIndex + 1} of ${currentDeck.length}`;
            
            const progress = ((currentCardIndex + 1) / currentDeck.length) * 100;
            document.getElementById('studyProgress').style.width = progress + '%';

            // Update navigation buttons
            document.getElementById('prevBtn').disabled = currentCardIndex === 0;
            document.getElementById('nextBtn').disabled = currentCardIndex === currentDeck.length - 1;

            // Update difficulty buttons
            updateDifficultyButtons(originalIndex);

            // Reset flip state
            resetFlip();

            // Add transition animation
            const flashcard = document.getElementById('flashcard');
            flashcard.classList.add('card-transition');
            setTimeout(() => flashcard.classList.remove('card-transition'), 300);

            // Handle auto-advance
            if (autoAdvanceEnabled) {
                startAutoAdvanceTimer();
            }
        }

        function updateDifficultyButtons(originalIndex) {
            const buttons = document.querySelectorAll('.difficulty-btn');
            buttons.forEach(btn => btn.classList.remove('active'));

            if (cardProgress[originalIndex] && cardProgress[originalIndex].difficulty) {
                const difficulty = cardProgress[originalIndex].difficulty;
                const activeBtn = document.querySelector(`.difficulty-btn.${difficulty}`);
                if (activeBtn) activeBtn.classList.add('active');
            }
        }

        function flipCard() {
            const flashcard = document.getElementById('flashcard');
            isFlipped = !isFlipped;
            
            if (isFlipped) {
                flashcard.classList.add('flipped');
                // Mark as studied when first flipped
                const originalIndex = getCurrentCardIndex();
                cardProgress[originalIndex].studied = true;
                updateStats();
            } else {
                flashcard.classList.remove('flipped');
            }
        }

        function resetFlip() {
            const flashcard = document.getElementById('flashcard');
            flashcard.classList.remove('flipped');
            isFlipped = false;
        }

        function nextCard() {
            if (currentCardIndex < currentDeck.length - 1) {
                currentCardIndex++;
                updateCard();
            }
        }

        function previousCard() {
            if (currentCardIndex > 0) {
                currentCardIndex--;
                updateCard();
            }
        }

        function rateDifficulty(difficulty) {
            const originalIndex = getCurrentCardIndex();
            cardProgress[originalIndex].difficulty = difficulty;
            cardProgress[originalIndex].studied = true;
            cardProgress[originalIndex].reviewCount++;
            
            updateDifficultyButtons(originalIndex);
            updateStats();

            // Auto-advance to next card after rating
            setTimeout(() => {
                if (currentCardIndex < currentDeck.length - 1) {
                    nextCard();
                } else {
                    // Reached end of deck
                    alert('Congratulations! You\'ve completed this deck. Great job studying!');
                    backToDashboard();
                }
            }, 500);
        }

        function backToDashboard() {
            document.getElementById('studyView').classList.add('hidden');
            document.getElementById('dashboard').classList.remove('hidden');
            
            if (autoAdvanceTimer) {
                clearTimeout(autoAdvanceTimer);
                autoAdvanceTimer = null;
            }
            
            updateStats();
        }

        // Auto-advance functionality
        function toggleAutoAdvance() {
            autoAdvanceEnabled = document.getElementById('autoAdvance').checked;
            
            if (!autoAdvanceEnabled && autoAdvanceTimer) {
                clearTimeout(autoAdvanceTimer);
                autoAdvanceTimer = null;
                document.getElementById('timerDisplay').style.display = 'none';
            } else if (autoAdvanceEnabled && document.getElementById('studyView').style.display !== 'none') {
                startAutoAdvanceTimer();
            }
        }

        function startAutoAdvanceTimer() {
            if (autoAdvanceTimer) clearTimeout(autoAdvanceTimer);
            
            let timeLeft = 10;
            document.getElementById('timerDisplay').style.display = 'block';
            
            const countdown = () => {
                document.getElementById('timerDisplay').textContent = `Auto-advance in ${timeLeft}s`;
                timeLeft--;
                
                if (timeLeft >= 0) {
                    autoAdvanceTimer = setTimeout(countdown, 1000);
                } else {
                    nextCard();
                }
            };
            
            countdown();
        }

        function resetProgress() {
            if (confirm('Are you sure you want to reset all progress? This cannot be undone.')) {
                cardProgress = {};
                initializeProgress();
                updateStats();
                alert('Progress has been reset!');
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', (event) => {
            if (document.getElementById('studyView').style.display !== 'none') {
                switch(event.code) {
                    case 'Space':
                        event.preventDefault();
                        flipCard();
                        break;
                    case 'ArrowLeft':
                        event.preventDefault();
                        previousCard();
                        break;
                    case 'ArrowRight':
                        event.preventDefault();
                        nextCard();
                        break;
                    case 'Digit1':
                        event.preventDefault();
                        rateDifficulty('easy');
                        break;
                    case 'Digit2':
                        event.preventDefault();
                        rateDifficulty('medium');
                        break;
                    case 'Digit3':
                        event.preventDefault();
                        rateDifficulty('hard');
                        break;
                }
            } else {
                // Dashboard shortcuts
                switch(event.code) {
                    case 'KeyS':
                        event.preventDefault();
                        startStudy('sequential');
                        break;
                    case 'KeyR':
                        event.preventDefault();
                        startStudy('random');
                        break;
                }
            }
        });

        // Touch/swipe support for mobile
        let touchStartX = 0;
        let touchEndX = 0;

        document.addEventListener('touchstart', (event) => {
            touchStartX = event.changedTouches[0].screenX;
        });

        document.addEventListener('touchend', (event) => {
            touchEndX = event.changedTouches[0].screenX;
            handleSwipe();
        });

        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;
            
            if (document.getElementById('studyView').style.display !== 'none') {
                if (Math.abs(diff) > swipeThreshold) {
                    if (diff > 0) {
                        // Swipe left - next card
                        nextCard();
                    } else {
                        // Swipe right - previous card
                        previousCard();
                    }
                }
            }
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', () => {
            initializeProgress();
            updateStats();
            applyFilters();
        });
    </script>
</body>
</html>